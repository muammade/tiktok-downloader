<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="referrer" content="no-referrer">
    <title>X-Downloader | المحمل الخارق</title>
    <link href="https://fonts.googleapis.com/css2?family=Cairo:wght@400;700;900&display=swap" rel="stylesheet">
    <style>
        :root { --main: #ff0050; --sec: #00f2ea; --bg: #08080a; }
        * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Cairo', sans-serif; }
        
        body {
            background: var(--bg);
            color: white;
            min-height: 100vh;
            display: flex; flex-direction: column;
            background-image: linear-gradient(135deg, #08080a 0%, #1a1a2e 100%);
        }

        /* نافبار فخم */
        nav {
            width: 100%; padding: 20px 10%;
            background: rgba(0,0,0,0.5); backdrop-filter: blur(10px);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        .logo { font-size: 1.8rem; font-weight: 900; background: linear-gradient(to right, var(--main), var(--sec)); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }

        .hero { text-align: center; padding: 60px 20px; }
        .hero h1 { font-size: 3rem; font-weight: 900; margin-bottom: 15px; text-shadow: 0 0 20px rgba(255,0,80,0.3); }
        .hero p { color: #888; font-size: 1.2rem; }

        .main-container { width: 90%; max-width: 800px; margin: 0 auto; position: relative; }

        /* صندوق التحميل الزجاجي */
        .glass-box {
            background: rgba(255, 255, 255, 0.03);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 30px; padding: 40px;
            backdrop-filter: blur(20px); box-shadow: 0 25px 50px rgba(0,0,0,0.5);
        }

        .input-group {
            display: flex; background: rgba(0,0,0,0.5);
            border-radius: 20px; padding: 8px; border: 2px solid #333;
            transition: 0.3s;
        }
        .input-group:focus-within { border-color: var(--sec); box-shadow: 0 0 20px rgba(0, 242, 234, 0.2); }
        
        input {
            flex: 1; background: transparent; border: none;
            padding: 15px; color: white; font-size: 1.1rem; outline: none;
        }

        .btn-go {
            background: linear-gradient(45deg, var(--main), #ff4d79);
            border: none; padding: 15px 40px; border-radius: 15px;
            color: white; font-weight: 900; cursor: pointer; transition: 0.3s;
        }
        .btn-go:hover { transform: scale(1.05); box-shadow: 0 0 30px rgba(255,0,80,0.4); }

        /* عرض النتائج */
        #result { display: none; margin-top: 40px; animation: zoomIn 0.4s ease; }
        .preview-card { background: #111; border-radius: 20px; overflow: hidden; border: 1px solid #222; }
        #vCover { width: 100%; max-height: 400px; object-fit: contain; background: #000; }
        .v-info { padding: 20px; text-align: center; }
        .dl-btn {
            display: inline-block; width: 100%; padding: 18px;
            background: var(--sec); color: #000; text-decoration: none;
            font-weight: 900; border-radius: 15px; font-size: 1.2rem;
            transition: 0.3s;
        }

        .ad-space { margin: 30px 0; text-align: center; min-height: 90px; }

        @keyframes zoomIn { from { opacity: 0; transform: scale(0.9); } to { opacity: 1; transform: scale(1); } }
    </style>
</head>
<body>

    <nav>
        <div class="logo">X-SAVE</div>
        <div style="color: #666; font-weight: bold;">PREMIUM v2.0</div>
    </nav>

    <div class="hero">
        <h1>حمل بضغطة واحدة</h1>
        <p>تيك توك، فيسبوك، إنستجرام - جودة 4K</p>
    </div>

    <div class="main-container">
        <div class="ad-space">
            <script async="async" data-cfasync="false" src="https://pl28334678.effectivegatecpm.com/f54e9c6f51b6bf561ffbceea1f602cc5/invoke.js"></script>
            <div id="container-f54e9c6f51b6bf561ffbceea1f602cc5"></div>
        </div>

        <div class="glass-box">
            <div class="input-group">
                <input type="text" id="urlInput" placeholder="الصق رابط الفيديو هنا...">
                <button class="btn-go" id="startBtn">تحميل</button>
            </div>

            <div id="result">
                <div class="preview-card">
                    <img id="vCover" src="" alt="Preview">
                    <div class="v-info">
                        <h3 id="vTitle" style="margin-bottom: 20px;"></h3>
                        <a href="#" id="finalDl" class="dl-btn">حفظ الفيديو (HD)</a>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <footer style="margin-top: auto; padding: 40px; text-align: center; color: #444;">
        &copy; 2025 X-SAVE PRO - جميع الحقوق محفوظة
    </footer>

    <script>
        const startBtn = document.getElementById('startBtn');
        const urlInput = document.getElementById('urlInput');
        const resultDiv = document.getElementById('result');

        startBtn.onclick = async () => {
            const url = urlInput.value.trim();
            if(!url) return;

            startBtn.innerText = '...جاري القنص';
            startBtn.disabled = true;

            try {
                const res = await fetch(`/api/download?url=${encodeURIComponent(url)}`);
                const json = await res.json();

                if(json.code === 0) {
                    const data = json.data;
                    document.getElementById('vCover').src = data.cover;
                    document.getElementById('vTitle').innerText = data.title || "فيديو جاهز للتحميل";
                    
                    const vLink = data.hdplay || data.play;
                    const cleanUrl = vLink.startsWith('http') ? vLink : `https://www.tikwm.com${vLink}`;
                    
                    document.getElementById('finalDl').onclick = (e) => {
                        e.preventDefault();
                        window.open(cleanUrl, '_blank');
                    };
                    
                    resultDiv.style.display = 'block';
                    resultDiv.scrollIntoView({ behavior: 'smooth' });
                } else {
                    alert('عذراً، هذا الرابط محمي أو غير مدعوم حالياً.');
                }
            } catch (e) {
                alert('خطأ في الاتصال بالسيرفر.');
            } finally {
                startBtn.innerText = 'تحميل';
                startBtn.disabled = false;
            }
        };
    </script>
</body>
</html>
